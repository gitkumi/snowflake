FROM golang:1.24-alpine AS server

ARG PORT=8080
ENV PORT=${PORT}

ARG DATABASE_CONN_STRING
ENV DATABASE_CONN_STRING=${DATABASE_CONN_STRING}

ENV ENVIRONMENT=production
ENV GIN_MODE=release
ENV MIGRATE_DATABASE=true

WORKDIR /app

COPY . .

RUN make build

EXPOSE 8080

CMD ["./main"]
