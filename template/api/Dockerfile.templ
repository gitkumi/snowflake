FROM golang:1.24-alpine AS server

ARG PORT=8080
ENV PORT=${PORT}

ARG DATABASE_URL
ENV DATABASE_URL=${DATABASE_URL}

ENV ENVIRONMENT=production
ENV GIN_MODE=release
ENV MIGRATE_DB=true

WORKDIR /app

COPY . .

RUN make build

EXPOSE 8080

CMD ["./main"]
